{$DOMAIN:localhost} {
	# API reverse proxy — strip /api prefix before forwarding
	handle /api/* {
		uri strip_prefix /api
		reverse_proxy server:3000
	}

	# Colyseus WebSocket — proxy with upgrade support
	handle /colyseus/* {
		uri strip_prefix /colyseus
		reverse_proxy server:3000
	}

	# Redirect /admin to /admin/
	redir /admin /admin/ 308

	# Admin SPA — strip prefix and serve from /srv/admin
	handle_path /admin/* {
		root * /srv/admin
		try_files {path} /index.html
		file_server
	}

	# Client SPA — default catch-all
	handle {
		root * /srv/client
		try_files {path} /index.html
		file_server
	}
}
